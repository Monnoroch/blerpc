package com.test;

/**
 * <pre>
 * Service javadoc.
 * <pre>
 */
public class RxTestService {

  private final com.test.TestService service;
  private final java.util.logging.Logger logger;

  public RxTestService(com.test.TestService service, java.util.logging.Logger logger) {
    this.service = service;
    this.logger = logger;
  }

  /**
   * <pre>
   * Read method javadoc.
   * <pre>
   */
  public io.reactivex.Single<com.test.TestOutputValue> readValue(com.test.TestInputValue request) {
      return io.reactivex.Single.create(
          subscriber -> {
            com.blerpc.BleRpcController controller = new com.blerpc.BleRpcController();
            service.readValue(
                controller,
                request,
                response -> {
                  if (!controller.failed()) {
                    subscriber.onSuccess(response);
                  } else {
                    com.blerpc.RxOnError.loggingUncatchableExceptions(
                        subscriber, new Exception(controller.errorText()), logger);
                  }
                });
            subscriber.setCancellable(controller::startCancel);
          });
  }

  /**
   * <pre>
   * Subscribe method javadoc.
   * <pre>
   */
  public io.reactivex.Observable<com.test.TestOutputValue> subscribeValue(com.test.TestInputValue request) {
    return subscribeValue(request, new com.blerpc.BleRpcController());
  }

  /**
   * <pre>
   * Subscribe method javadoc.
   * <pre>
   */
  public io.reactivex.Observable<com.test.TestOutputValue> subscribeValue(com.test.TestInputValue request, com.blerpc.BleRpcController controller) {
      return io.reactivex.Observable.create(
          subscriber -> {
            service.subscribeValue(
                controller,
                request,
                response -> {
                  if (!controller.failed()) {
                    subscriber.onNext(response);
                  } else {
                    com.blerpc.RxOnError.loggingUncatchableExceptions(
                        subscriber, new Exception(controller.errorText()), logger);
                  }
                });
            subscriber.setCancellable(controller::startCancel);
          });
  }
}
